# ๐ ุงูุนูููุงุช ุงูุฅุฏุงุฑูุฉ ุงููุชูุฏูุฉ - ุจุนุฏ ุงูุชุญุณููุงุช

## ๐ฏ ุงูุนูููุงุช ุงูุฌุฏูุฏุฉ ุงููุชุงุญุฉ

ุจุนุฏ ุชุทุจูู ููู `supabase-enhancement.sql` ุณุชุญุตู ุนูู ููู ุฅุฏุงุฑูุฉ ุฌุฏูุฏุฉ!

---

## ๐ฅ ุงูุชุญูู ุงููุงูู ุจุงูุชุฌุงุฑ

### โก **ุชูุนูู/ุชุนุทูู ููุฑู**
```
๐ ุฌุฏูู: Merchant
๐๏ธ ุงูุญูู: isActive
โ true = ุงูุดุงุช ุจูุช ูุนูู
โ false = ุงูุดุงุช ุจูุช ูุชููู ููุฑุงู
```

### ๐ **ููุงุญุธุงุช ุฅุฏุงุฑูุฉ**
```
๐ ุฌุฏูู: Merchant  
๐ ุงูุญูู: adminNotes
๐ก ูุซุงู: "ุนููู ูุชููุฒ - ุฏุนู ุฃููููุฉ ุนุงููุฉ"
```

### ๐ **ุฅุนุฏุงุฏุงุช ุงูููุทูุฉ**
```
๐ ุฌุฏูู: Merchant
๐ timezone: Asia/Riyadh, America/New_York
๐ฃ๏ธ language: ar, en, fr
```

### ๐ข **ุญุฏูุฏ ููููุฉ ูุฎุตุตุฉ**
```
๐ ุฌุฏูู: Merchant
๐ maxDailyMessages: 100 (ุงูุชุฑุงุถู)
๐ฏ ูููู ุฒูุงุฏุชูุง ูุนููุงุก ูููุฒูู
```

### ๐ **ูููุฏ ุงููุทุงูุงุช**
```
๐ ุฌุฏูู: Merchant
๐ allowedDomains: ['example.com', 'shop.example.com']
๐ซ ุฅุฐุง ูุงู ูุงุฑุบ = ูุณููุญ ูู ุฃู ูุทุงู
```

### ๐ **ุฅุดุนุงุฑุงุช Webhook**
```
๐ ุฌุฏูู: Merchant
๐ webhookUrl: https://merchant.com/webhook
๐จ ุณูุณุชูุจู ุฅุดุนุงุฑุงุช ุนูุฏ ุฃุญุฏุงุซ ูููุฉ
```

---

## ๐ณ ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ ุงููุชูุฏูุฉ

### ๐ฐ **ุชุณุนูุฑ ูุฎุตุต**
```
๐ ุฌุฏูู: Subscription
๐ต pricePerMonth: 29.99
๐ฑ currency: USD, SAR, EUR
```

### ๐ **ูุธุงู ุงูุฎุตููุงุช**
```
๐ ุฌุฏูู: Subscription
๐ท๏ธ discountPercent: 15 (ุฎุตู 15%)
๐ฐ ุงููุชูุฌุฉ: ุงูุนููู ูุฏูุน 85% ูู ุงูุณุนุฑ ุงูุฃุตูู
```

### ๐ **ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู**
```
๐ ุฌุฏูู: Subscription
๐ autoRenew: true/false
๐ nextBillingDate: 2025-02-25
```

### โ๏ธ **ุญุฏูุฏ ูุฎุตุตุฉ**
```
๐ ุฌุฏูู: Subscription
๐ customLimits: {"dailyMessages": 200, "fileUploads": 10}
๐ฏ ุญุฏูุฏ ูุฎุตุตุฉ ุจุชูุณูู JSON
```

### ๐ก๏ธ **ุงูููุฒุงุช ุงููุชุงุญุฉ**
```
๐ ุฌุฏูู: Subscription
๐ features: ['basic_chat', 'file_upload', 'analytics', 'api_access']
โจ ุชุญูู ุฏููู ูู ุงูููุฒุงุช ููู ุนููู
```

### ๐ซ **ุฅููุงู ูุน ุงูุณุจุจ**
```
๐ ุฌุฏูู: Subscription
โธ๏ธ status: SUSPENDED
๐ suspendReason: "ุชุฃุฎุฑ ูู ุงูุฏูุน - 15 ููู"
```

---

## ๐ ูุฑุงูุจุฉ ุดุงููุฉ ููุฃุฏุงุก

### ๐ **ุฅุญุตุงุฆูุงุช ููููุฉ ุชููุงุฆูุฉ**
```
๐ ุฌุฏูู: MerchantAnalytics
๐ date: 2025-01-25
๐ฌ totalConversations: 45
๐จ totalMessages: 230
๐ฅ uniqueUsers: 38
โฑ๏ธ avgResponseTime: 1.2 ุซุงููุฉ
โ errorCount: 2
โก uptime: 99.85%
```

### ๐ **ุชุชุจุน ูุงูู ููุชุบููุฑุงุช**
```
๐ ุฌุฏูู: AdminAuditLog
๐ค adminUser: "admin_zeyad"
๐ฏ targetTable: "Merchant"
๐ targetId: "merchant_123"
๐ฌ action: "UPDATE"
๐ reason: "ุชูุนูู ุญุณุงุจ ุจุนุฏ ุฏูุน ุงููุณุชุญูุงุช"
๐ ipAddress: "192.168.1.100"
๐ createdAt: 2025-01-25 14:30:00
```

---

## ๐๏ธ ุณููุงุฑูููุงุช ุนูููุฉ ูุชูุฏูุฉ

### ๐ฏ **ุณููุงุฑูู 1: ุนููู VIP**
```
1๏ธโฃ ุฌุฏูู Merchant:
   โ๏ธ adminNotes: "ุนููู VIP - ุฏุนู ููุฑู"
   ๐ maxDailyMessages: 500

2๏ธโฃ ุฌุฏูู Subscription:
   ๐ฐ pricePerMonth: 199.00
   ๐ features: ['premium_chat', 'priority_support', 'custom_ai']
   ๐ customLimits: {"priority": 1, "dedicatedSupport": true}
```

### ๐ฏ **ุณููุงุฑูู 2: ุนููู ูุชุฃุฎุฑ ูู ุงูุฏูุน**
```
1๏ธโฃ ุฌุฏูู Subscription:
   โธ๏ธ status: SUSPENDED
   ๐ suspendReason: "ูุชุฃุฎุฑ ูู ุงูุฏูุน 10 ุฃูุงู"

2๏ธโฃ ุฌุฏูู Merchant:
   โ isActive: false
   ๐ adminNotes: "ูุนูู ูุญูู ุณุฏุงุฏ ุงููุณุชุญูุงุช"

3๏ธโฃ ุณุฌู ูู AdminAuditLog:
   ๐ฌ action: SUSPEND
   ๐ reason: "Overdue payment - 10 days"
```

### ๐ฏ **ุณููุงุฑูู 3: ุชุฑููุฉ ุนููู**
```
1๏ธโฃ ุฌุฏูู Subscription:
   ๐ plan: PREMIUM (ูุงู BASIC)
   ๐ฐ pricePerMonth: 99.00 (ูุงู 29.00)
   ๐ messagesLimit: 15000 (ูุงู 1000)
   ๐ features: ['premium_chat', 'analytics', 'api_access']

2๏ธโฃ ุณุฌู ูู AdminAuditLog:
   ๐ฌ action: UPGRADE
   ๐ reason: "ุชุฑููุฉ ุจูุงุก ุนูู ุทูุจ ุงูุนููู"
```

### ๐ฏ **ุณููุงุฑูู 4: ุนููู ูุณุชููู ูุซูุฑุงู**
```
1๏ธโฃ ูุฑุงูุจุฉ ูู MerchantAnalytics:
   ๐ totalMessages: 950 (ูู ุญุฏ 1000)
   โ๏ธ ุชูุจูู: ูุฑูุจ ูู ุงูุญุฏ!

2๏ธโฃ ุฅุฌุฑุงุก ููุงุฆู:
   ๐ maxDailyMessages: 50 (ุชูููู ุงูุญุฏ ุงููููู)
   ๐ adminNotes: "ูุฑุงูุจุฉ ุงูุงุณุชููุงู - ุญุฏ ูููู ูููุฏ"
```

---

## ๐ ุงุณุชุนูุงูุงุช ูููุฏุฉ ุฌุฏูุฏุฉ

### ๐ **ุงูุชุฌุงุฑ ุงูุฃูุซุฑ ูุดุงุทุงู**
```sql
SELECT 
  m."businessName",
  ma."totalMessages",
  ma."totalConversations",
  ma."avgResponseTime"
FROM "Merchant" m
JOIN "MerchantAnalytics" ma ON ma."merchantId" = m.id
WHERE ma."date" = CURRENT_DATE
ORDER BY ma."totalMessages" DESC
LIMIT 10;
```

### ๐ฐ **ุญุณุงุจ ุงูุฅูุฑุงุฏุงุช ุงููุนููุฉ**
```sql
SELECT 
  SUM(s."pricePerMonth" * (100 - s."discountPercent") / 100) as "monthlyRevenue"
FROM "Subscription" s
WHERE s.status = 'ACTIVE';
```

### ๐จ **ุงูุนููุงุก ุงููุนุฑุถูู ููุฎุทุฑ**
```sql
SELECT 
  m."businessName",
  s."messagesUsed",
  s."messagesLimit",
  ROUND((s."messagesUsed"::decimal / s."messagesLimit") * 100, 2) as "usagePercent"
FROM "Merchant" m
JOIN "Subscription" s ON s."merchantId" = m.id
WHERE (s."messagesUsed"::decimal / s."messagesLimit") > 0.9
ORDER BY "usagePercent" DESC;
```

### ๐ **ุชุญููู ุงูุฃุฏุงุก ุงูุฃุณุจูุนู**
```sql
SELECT 
  DATE_TRUNC('week', ma."date") as "week",
  AVG(ma."totalMessages") as "avgMessages",
  AVG(ma."avgResponseTime") as "avgResponseTime",
  AVG(ma."uptime") as "avgUptime"
FROM "MerchantAnalytics" ma
WHERE ma."date" >= CURRENT_DATE - INTERVAL '4 weeks'
GROUP BY DATE_TRUNC('week', ma."date")
ORDER BY "week" DESC;
```

### ๐ **ุณุฌู ุงูุชุบููุฑุงุช ุงูุฃุฎูุฑุฉ**
```sql
SELECT 
  al."adminUser",
  al."action",
  al."targetTable",
  al."reason",
  al."createdAt"
FROM "AdminAuditLog" al
ORDER BY al."createdAt" DESC
LIMIT 20;
```

---

## ๐ฏ ุงูููุงู ุงูุฅุฏุงุฑูุฉ ุงูุฌุฏูุฏุฉ

### ๐ **ููููุงู (5 ุฏูุงุฆู):**
1. โ ูุญุต `MerchantAnalytics` ููุฅุญุตุงุฆูุงุช ุงูููููุฉ
2. ๐ ูุฑุงุฌุนุฉ `AdminAuditLog` ููุชุบููุฑุงุช ุงููุดุจููุฉ
3. โ๏ธ ูุฑุงูุจุฉ ุงูุนููุงุก ุงููุฑูุจูู ูู ุญุฏ ุงูุฑุณุงุฆู
4. ๐ฐ ูุญุต ุงูุชุฌุฏูุฏุงุช ุงููุงุฏูุฉ ูู `nextBillingDate`

### ๐ **ุฃุณุจูุนูุงู (15 ุฏูููุฉ):**
1. ๐ ุชุญููู ุงูุงุชุฌุงูุงุช ูู `MerchantAnalytics`
2. ๐ฐ ูุฑุงุฌุนุฉ ุงูุฅูุฑุงุฏุงุช ูุงูุฎุตููุงุช
3. ๐ ุชุญุฏูุซ ุงูููุฒุงุช ูุงูุญุฏูุฏ ุญุณุจ ุงูุญุงุฌุฉ
4. ๐ ูุฑุงุฌุนุฉ `adminNotes` ูุชุญุฏูุซูุง

### ๐ **ุดูุฑูุงู (30 ุฏูููุฉ):**
1. ๐ ุชูุฑูุฑ ุดุงูู ููุฅูุฑุงุฏุงุช ูุงูููู
2. ๐ ุชุญููู ุฃุฏุงุก ุงูุนููุงุก ูุชุตููููู
3. ๐ฏ ุชุญุฏูุฏ ูุฑุต ุงูุชุฑููุฉ ูุงูุชุญุณูู
4. ๐งน ุชูุธูู ุงูุจูุงูุงุช ุงููุฏููุฉ

---

## ๐ ุงูููู ุงูุฌุฏูุฏุฉ ุงูููุชุณุจุฉ

### โ **ุชุญูู ูุงูู 100%:**
- ุชูุนูู/ุชุนุทูู ููุฑู ูุฃู ุชุงุฌุฑ
- ููุงุญุธุงุช ุฅุฏุงุฑูุฉ ููุตูุฉ
- ุญุฏูุฏ ูุฎุตุตุฉ ููู ุนููู
- ูููุฏ ุงููุทุงูุงุช ูุงูุฃูุงู

### ๐ฐ **ุฅุฏุงุฑุฉ ูุงููุฉ ุงุญุชุฑุงููุฉ:**
- ุชุณุนูุฑ ูุฑู ููุฎุตุต
- ูุธุงู ุฎุตููุงุช ูุชุทูุฑ
- ุชุชุจุน ุงูููุชุฑุฉ ูุงูุชุฌุฏูุฏ
- ุชุญููู ุงูุฅูุฑุงุฏุงุช ุงูุฏููู

### ๐ **ูุฑุงูุจุฉ ุดุงููุฉ:**
- ุฅุญุตุงุฆูุงุช ููููุฉ ุชููุงุฆูุฉ
- ุชุชุจุน ุงูุฃุฏุงุก ูุงูุฃุฎุทุงุก
- ุณุฌู ูุงูู ููุชุบููุฑุงุช
- ุชูุจููุงุช ุงุณุชุจุงููุฉ

### ๐๏ธ **ูุฑููุฉ ุชุงูุฉ:**
- ููุฒุงุช ูุงุจูุฉ ููุชุฎุตูุต
- ุญุฏูุฏ ุฏููุงููููุฉ
- ุฅุนุฏุงุฏุงุช ูุชูุฏูุฉ
- ุชูุงูู ูุน ุงูุฃูุธูุฉ ุงูุฎุงุฑุฌูุฉ

---

## ๐ ุงูุฎูุงุตุฉ

ูุน ูุฐู ุงูุชุญุณููุงุชุ ุฃุตุจุญ ูุฏูู **ูุธุงู ุฅุฏุงุฑุฉ ูุชูุงูู** ูุถุงูู ุฃููู ููุตุงุช SaaS ูู ุงูุนุงูู:

๐ **ุชุญูู ูุงูู** ูู ูู ุฌุงูุจ ูู ุฌูุงูุจ ุงูููุตุฉ  
๐ **ุฑุคู ุนูููุฉ** ููุฃุฏุงุก ูุงูุงุณุชุฎุฏุงู  
๐ **ูุฑููุฉ ูุง ูุญุฏูุฏุฉ** ูู ุงูุชุฎุตูุต  
๐ **ุฃูุงู ูุชูุฏู** ูุน ุชุชุจุน ุดุงูู  
๐ฐ **ุฅุฏุงุฑุฉ ูุงููุฉ ุงุญุชุฑุงููุฉ** ููููู ูุงูุฑุจุญูุฉ  

**ุฃูุช ุงูุขู ุชููู ุฅูุจุฑุงุทูุฑูุฉ ุชูููุฉ ุญููููุฉ! ๐** 