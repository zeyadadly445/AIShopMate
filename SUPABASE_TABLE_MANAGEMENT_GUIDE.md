# 🎛️ دليل إدارة الجداول عبر واجهة Supabase

## 🚀 الوصول للجداول

### 1. **تسجيل الدخول:**
1. اذهب إلى: `https://supabase.com/dashboard`
2. سجل دخولك
3. اختر مشروع AI Shop Mate

### 2. **الوصول للجداول:**
1. من القائمة الجانبية اختر `Table Editor`
2. ستجد جميع الجداول:
   - `Merchant` - بيانات التجار
   - `Subscription` - الاشتراكات
   - `Conversation` - المحادثات
   - `Message` - الرسائل

---

## 👥 إدارة التجار (Merchant Table)

### 📋 **عرض جميع التجار:**
1. انقر على جدول `Merchant`
2. ستظهر لك جميع التجار مع البيانات:
   - `id` - المعرف الفريد
   - `email` - البريد الإلكتروني
   - `business_name` - اسم المتجر
   - `phone` - رقم الهاتف
   - `chatbot_id` - معرف الشات بوت
   - `is_active` - حالة النشاط
   - `created_at` - تاريخ التسجيل

### ✏️ **تعديل بيانات تاجر:**
1. انقر على الصف الذي تريد تعديله
2. انقر على أيقونة القلم ✏️ (Edit)
3. عدل البيانات المطلوبة:
   - `business_name`: غير اسم المتجر
   - `phone`: عدل رقم الهاتف
   - `is_active`: غير من `true` إلى `false` لتعطيل الحساب
4. انقر `Save` للحفظ

### 🚫 **تعطيل حساب تاجر:**
1. ابحث عن التاجر في جدول `Merchant`
2. انقر على صفه للتعديل
3. غير `is_active` من `true` إلى `false`
4. احفظ التغييرات
5. **النتيجة**: سيتوقف الشات بوت عن العمل فوراً

### ➕ **إضافة تاجر جديد:**
1. انقر على `Insert` > `Insert row`
2. املأ البيانات:
   ```
   email: merchant@example.com
   business_name: اسم المتجر
   phone: +966501234567
   chatbot_id: bot_123456789
   welcome_message: مرحباً بك!
   primary_color: #3b82f6
   is_active: true
   ```
3. انقر `Save`

### 🗑️ **حذف تاجر:**
1. انقر على صف التاجر
2. انقر على أيقونة سلة المهملات 🗑️
3. أكد الحذف
4. **تحذير**: سيتم حذف جميع البيانات المرتبطة!

---

## 💳 إدارة الاشتراكات (Subscription Table)

### 📋 **عرض جميع الاشتراكات:**
1. انقر على جدول `Subscription`
2. ستظهر الاشتراكات مع:
   - `id` - معرف الاشتراك
   - `merchant_id` - معرف التاجر
   - `plan` - نوع الخطة (BASIC, STANDARD, PREMIUM, ENTERPRISE)
   - `status` - الحالة (ACTIVE, TRIAL, EXPIRED, CANCELLED)
   - `messages_limit` - حد الرسائل
   - `messages_used` - الرسائل المستخدمة
   - `start_date` - تاريخ البداية
   - `end_date` - تاريخ الانتهاء

### 📈 **ترقية اشتراك:**
1. ابحث عن الاشتراك المطلوب
2. انقر للتعديل
3. غير البيانات:
   ```
   plan: PREMIUM (بدلاً من BASIC)
   messages_limit: 15000 (بدلاً من 1000)
   status: ACTIVE
   end_date: 2025-02-25 (شهر من اليوم)
   ```
4. احفظ التغييرات

### 🔄 **إعادة تعيين عدد الرسائل:**
1. ابحث عن الاشتراك
2. انقر للتعديل
3. غير `messages_used` إلى `0`
4. احفظ التغييرات
5. **النتيجة**: سيستطيع التاجر إرسال رسائل مرة أخرى

### ⏰ **تمديد اشتراك:**
1. ابحث عن الاشتراك المنتهي
2. انقر للتعديل
3. غير:
   ```
   status: ACTIVE (بدلاً من EXPIRED)
   end_date: 2025-03-25 (تاريخ جديد)
   ```
4. احفظ التغييرات

### 🚫 **إيقاف اشتراك:**
1. ابحث عن الاشتراك
2. انقر للتعديل
3. غير:
   ```
   status: CANCELLED
   end_date: اليوم (التاريخ الحالي)
   ```
4. احفظ التغييرات
5. **النتيجة**: سيتوقف الشات بوت عن العمل

### ➕ **إنشاء اشتراك جديد:**
1. انقر `Insert` > `Insert row`
2. املأ البيانات:
   ```
   merchant_id: (معرف التاجر من جدول Merchant)
   plan: BASIC
   status: TRIAL
   messages_limit: 1000
   messages_used: 0
   start_date: اليوم
   end_date: بعد 7 أيام (للتجربة)
   ```
3. احفظ

---

## 🔍 البحث والفلترة

### 🔎 **البحث عن تاجر معين:**
1. في جدول `Merchant`
2. استخدم مربع البحث في الأعلى
3. ابحث بـ:
   - البريد الإلكتروني
   - اسم المتجر
   - معرف الشات بوت

### 📊 **فلترة الاشتراكات:**
1. في جدول `Subscription`
2. انقر على أيقونة الفلتر 🔽 بجانب العمود
3. **أمثلة للفلترة:**
   - `status` = `ACTIVE` (الاشتراكات النشطة فقط)
   - `plan` = `PREMIUM` (الخطط المميزة فقط)
   - `messages_used` > `800` (القريبين من الحد)

### 📅 **فلترة حسب التاريخ:**
1. انقر على فلتر عمود `created_at`
2. اختر:
   - آخر 7 أيام
   - آخر 30 يوم
   - نطاق تاريخ مخصص

---

## ⚡ عمليات سريعة ومفيدة

### 🔥 **مهام يومية:**

#### 1. **فحص الاشتراكات المنتهية:**
1. اذهب لجدول `Subscription`
2. فلتر `status` = `ACTIVE`
3. فلتر `end_date` < `اليوم`
4. ستظهر الاشتراكات التي انتهت لكنها ما زالت نشطة

#### 2. **مراقبة استهلاك الرسائل:**
1. في جدول `Subscription`
2. رتب العمود `messages_used` تنازلياً
3. ستظهر الحسابات الأكثر استخداماً

#### 3. **التجار الجدد اليوم:**
1. في جدول `Merchant`
2. فلتر `created_at` = `اليوم`
3. ستظهر التسجيلات الجديدة

### 🚨 **حالات الطوارئ:**

#### ⛔ **إيقاف جميع الشات بوتس:**
1. اذهب لجدول `Merchant`
2. حدد جميع الصفوف (Ctrl+A)
3. انقر `Bulk Edit`
4. غير `is_active` إلى `false`
5. احفظ التغييرات

#### 🔄 **إعادة تعيين شاملة للرسائل:**
1. اذهب لجدول `Subscription`
2. حدد جميع الصفوف
3. انقر `Bulk Edit`
4. غير `messages_used` إلى `0`
5. احفظ التغييرات

---

## 📊 مراقبة الإحصائيات

### 📈 **معلومات سريعة:**
1. في أسفل كل جدول ستجد عدد الصفوف
2. استخدم الفلاتر لحساب:
   - عدد التجار النشطين
   - عدد الاشتراكات النشطة
   - إجمالي الرسائل المستخدمة

### 📋 **تصدير البيانات:**
1. بعد تطبيق الفلاتر المطلوبة
2. انقر على أيقونة التحميل 📥
3. اختر `Export as CSV`
4. ستحصل على ملف Excel للتحليل

---

## 💡 نصائح مهمة

### ✅ **أفضل الممارسات:**

1. **تحديث منتظم**: راجع الجداول يومياً
2. **نسخ احتياطية**: صدّر البيانات أسبوعياً
3. **فلترة ذكية**: استخدم الفلاتر لتوفير الوقت
4. **حذر في الحذف**: تأكد قبل حذف أي بيانات

### ⚠️ **تحذيرات:**

1. **حذف التاجر**: يحذف جميع محادثاته ورسائله
2. **تعطيل الحساب**: يوقف الشات بوت فوراً
3. **تغيير حد الرسائل**: يؤثر على عمل الخدمة
4. **تاريخ الانتهاء**: تأكد من التواريخ صحيحة

### 🎯 **اختصارات مفيدة:**
- `Ctrl + F`: البحث السريع
- `Ctrl + A`: تحديد الكل
- `Tab`: الانتقال بين الحقول
- `Enter`: حفظ التعديل
- `Esc`: إلغاء التعديل

---

## 🔥 سيناريوهات عملية

### 🎯 **سيناريو 1: عميل يشكو من توقف الشات بوت**
1. ابحث عن العميل في جدول `Merchant` بالبريد الإلكتروني
2. تحقق من `is_active` - إذا كان `false` فعّله
3. اذهب لجدول `Subscription` وابحث بـ `merchant_id`
4. تحقق من:
   - `status` يجب أن يكون `ACTIVE` أو `TRIAL`
   - `end_date` لم ينته بعد
   - `messages_used` أقل من `messages_limit`
5. صحح المشكلة وأعلم العميل

### 🎯 **سيناريو 2: عميل يريد ترقية خطته**
1. ابحث عن اشتراكه في جدول `Subscription`
2. غير `plan` من `BASIC` إلى `PREMIUM`
3. غير `messages_limit` إلى `15000`
4. غير `end_date` إلى شهر من اليوم
5. تأكد أن `status` = `ACTIVE`

### 🎯 **سيناريو 3: عميل استنفد رسائله**
1. ابحث عن اشتراكه
2. إذا كان يستحق إعادة تعيين: غير `messages_used` إلى `0`
3. أو أعطه رسائل إضافية: زد `messages_limit`
4. أو انتظر التجديد الشهري الطبيعي

---

## 🎊 الخلاصة

الآن تستطيع إدارة **كل شيء** من واجهة Supabase البسيطة:

✅ **إدارة التجار** - تفعيل/تعطيل/تعديل/حذف  
✅ **إدارة الاشتراكات** - ترقية/تمديد/إيقاف  
✅ **مراقبة الاستخدام** - رسائل/حدود/تواريخ  
✅ **البحث والفلترة** - عثور سريع على أي بيانات  
✅ **عمليات مجمعة** - تعديل عدة حسابات مرة واحدة  
✅ **تصدير وتحليل** - ملفات CSV للإحصائيات  

🚀 **كل هذا بدون كتابة سطر واحد من SQL!** 